# 重構指令

安全地重構程式碼，保持功能不變的同時改善程式碼品質。

## 重構步驟

1. **分析現有程式碼**
   - 識別重複的程式碼
   - 找出過於複雜的函式或元件
   - 檢查是否有違反 SOLID 原則的地方

2. **建立測試（如沒有）**
   - 為要重構的程式碼建立測試
   - 確保測試覆蓋主要功能
   - 執行測試確認通過

3. **重構策略**
   - **提取函式**：將重複邏輯提取為共用函式
   - **提取元件**：將大型元件拆分為較小的元件
   - **重命名**：改善變數和函式命名
   - **簡化條件**：簡化複雜的條件判斷
   - **移除死碼**：刪除未使用的程式碼

4. **驗證重構**
   - 執行所有測試確保功能不變
   - 執行 lint 檢查
   - 手動測試主要功能流程

5. **提交變更**
   - 使用語意化提交訊息：`refactor: 描述重構內容`

## 重構原則

- **小步重構**：每次只重構一小部分
- **保持測試通過**：重構過程中測試必須持續通過
- **功能不變**：重構不應改變程式碼的行為
- **改善可讀性**：優先改善程式碼的可讀性和可維護性

## 執行方式

在 Agent 聊天框輸入 `/refactor` 並標記要重構的檔案，例如：
```
/refactor @src/app/api/rooms/route.ts
```

## 常見重構場景

- 提取重複的 API 邏輯為共用函式
- 拆分超過 300 行的元件
- 簡化複雜的條件判斷
- 統一錯誤處理模式
- 改善型別定義和介面
