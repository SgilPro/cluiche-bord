# Task Management 機制

## 概述

本文件說明如何使用 Cursor Agent 進行任務管理和協作。結合 Plan Mode、Checkpoints 和任務追蹤，建立高效的開發工作流程。

## Plan Mode 工作流程

### 1. 啟動 Plan Mode
- 在 Agent 輸入框按下 `Shift + Tab` 切換到 Plan Mode
- Agent 會先分析程式碼庫，提出釐清問題
- 建立包含檔案路徑和程式碼參照的詳細實作計畫

### 2. 檢閱和調整計畫
- 計畫會以 Markdown 檔案開啟
- 可以直接編輯計畫：
  - 刪除不必要的步驟
  - 調整實作方法
  - 補充 Agent 遺漏的脈絡

### 3. 儲存計畫
- 點擊「Save to workspace」將計畫儲存到 `.cursor/plans/`
- 檔案命名格式：`YYYY-MM-DD-功能名稱.md`
- 這可以：
  - 為團隊建立文件
  - 讓中斷的工作容易繼續
  - 為未來在同一功能上工作的 Agent 提供脈絡

### 4. 執行計畫
- 核准計畫後，Agent 開始實作
- 可以隨時使用 Checkpoints 還原到之前的狀態

## 任務追蹤

### 任務檔案結構
在 `.cursor/plans/` 目錄下建立任務檔案：

```markdown
# 任務名稱

## 狀態
- [ ] 待開始
- [x] 進行中
- [x] 已完成

## 描述
任務的詳細描述

## 相關檔案
- `src/app/api/rooms/route.ts`
- `src/components/GameRoom.tsx`

## 檢查清單
- [ ] 步驟 1
- [ ] 步驟 2
- [ ] 步驟 3

## 備註
任何額外的說明或注意事項
```

### 任務狀態管理
- **待開始**：計畫已建立，尚未開始實作
- **進行中**：正在實作中
- **已完成**：功能已完成並通過測試
- **已取消**：任務被取消或暫停

## Checkpoints 使用

### 何時使用 Checkpoints
- Agent 偏離預期方向時
- 需要嘗試不同實作方法時
- 發現重大錯誤需要還原時

### 使用方式
1. 在 Agent 聊天介面找到 Checkpoint 選項
2. 選擇要還原的 Checkpoint
3. 調整計畫或提供更明確的指示
4. 重新執行 Agent

### 最佳實踐
- **不要害怕還原**：與其在錯誤基礎上修正，不如還原並重新開始
- **調整計畫**：還原後，先調整計畫再重新執行
- **保持 Checkpoint 乾淨**：定期清理不需要的 Checkpoints

## 任務中斷與恢復

### 中斷工作
1. 儲存當前計畫到 `.cursor/plans/`
2. 記錄當前進度和狀態
3. 提交變更到 Git（如需要）

### 恢復工作
1. 讀取相關的計畫檔案
2. 使用 `@Past Chats` 引用過去的對話
3. 使用 `@` 標記相關檔案提供脈絡
4. 繼續執行未完成的任務

## 協作機制

### 團隊協作
- **共享計畫**：將計畫檔案提交到 Git，讓團隊成員了解進度
- **任務分配**：在計畫檔案中標記負責人
- **進度更新**：定期更新任務狀態

### Agent 協作
- **明確分工**：將大型任務拆分為多個小任務
- **依序執行**：確保任務之間的依賴關係
- **驗證結果**：每個任務完成後進行驗證

## 任務範本

### 新功能開發範本
```markdown
# [功能名稱]

## 狀態
- [ ] 待開始

## 需求描述
[詳細描述功能需求]

## 技術方案
[說明技術實作方案]

## 相關檔案
- [列出相關檔案]

## 實作步驟
1. [步驟 1]
2. [步驟 2]
3. [步驟 3]

## 測試計畫
- [ ] 單元測試
- [ ] 整合測試
- [ ] 手動測試

## 備註
[任何額外說明]
```

### Bug 修復範本
```markdown
# [Bug 描述]

## 狀態
- [ ] 待開始

## 問題描述
[詳細描述問題]

## 重現步驟
1. [步驟 1]
2. [步驟 2]
3. [步驟 3]

## 預期行為
[預期應該發生的行為]

## 實際行為
[實際發生的行為]

## 相關檔案
- [列出相關檔案]

## 修復方案
[說明修復方案]

## 測試計畫
- [ ] 驗證修復
- [ ] 確保沒有回歸
```

## 最佳實踐

### 任務規劃
1. **從規劃開始**：使用 Plan Mode 建立詳細計畫
2. **明確目標**：提供具體、可驗證的目標
3. **拆分任務**：將大型任務拆分為可管理的小任務

### 執行任務
1. **保持專注**：一次專注一個任務
2. **驗證進度**：定期驗證任務進度
3. **及時調整**：發現問題及時調整計畫

### 完成任務
1. **測試驗證**：確保功能正常運作
2. **程式碼審查**：使用 `/review` 指令審查程式碼
3. **更新文件**：更新相關文件
4. **提交變更**：使用語意化提交訊息

## 工具和指令

### 常用指令
- `/review`：程式碼審查
- `/test-fix`：測試與修復
- `/feature-setup`：新功能設定
- `/refactor`：重構程式碼
- `/debug`：除錯模式
- `/migration`：資料庫 migration

### 檔案引用
- `@file`：引用特定檔案
- `@code`：引用特定程式碼區塊
- `@Past Chats`：引用過去的對話

## 範例工作流程

### 範例：開發新功能
1. 使用 Plan Mode 建立計畫
2. 儲存計畫到 `.cursor/plans/2025-01-XX-功能名稱.md`
3. 核准並執行計畫
4. 使用 Checkpoints 管理進度
5. 完成後使用 `/review` 審查
6. 使用 `/test-fix` 確保測試通過
7. 提交變更並更新任務狀態

### 範例：修復 Bug
1. 使用 `/debug` 指令分析問題
2. 建立修復計畫
3. 實作修復
4. 驗證修復
5. 確保沒有回歸
6. 提交修復
